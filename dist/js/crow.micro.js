var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};
goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};
goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(!COMPILED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,f=0;d=b[f];f++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=
-1==d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+
a+'">\x3c/script>');return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var g in d.requires[e])if(!goog.isProvided_(g))if(g in d.nameToPath)a(d.nameToPath[g]);else throw Error("Undefined nameToPath for "+g);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},d;for(d in c){var e=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e)}return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};var crow={util:{}};crow.util.MonkeyPatches={};Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c=this.length>>>0,d=Number(b)||0,d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=c);d<c;d++)if(d in this&&this[d]===a)return d;return-1});Array.prototype.shuffle||(Array.prototype.shuffle=function(){for(var a=this.concat(),b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a});crow.Logger={};
(function(){var a={error:1,warn:2,info:3,debug:4,off:-Infinity},b=goog.global.console?console:{},c=a.warn;crow.Logger=function(a){this.klass=a};crow.Logger.prototype.getLogLevel=function(){return"undefined"!==typeof this.klass.LOG_LEVEL?this.klass.LOG_LEVEL:c};crow.Logger.prototype.error=function(){var a=Array.prototype.slice.call(arguments,0);a[0]="Crow Error: "+a[0];b&&(b.error&&1<=this.getLogLevel())&&b.error.apply(b,a)};crow.Logger.prototype.warn=function(){var a=Array.prototype.slice.call(arguments,0);
a[0]="Crow Warning: "+a[0];b&&(b.warn&&2<=this.getLogLevel())&&b.warn.apply(b,a)};crow.Logger.prototype.info=function(){var a=Array.prototype.slice.call(arguments,0);a[0]="Crow Info: "+a[0];b&&(b.info&&3<=this.getLogLevel())&&b.info.apply(b,a)};crow.Logger.prototype.debug=function(){var a=Array.prototype.slice.call(arguments,0);a[0]="Crow Debug: "+a[0];b&&(b.debug&&4<=this.getLogLevel())&&b.debug.apply(b,a)};crow.Logger.prototype.setLevel=function(a){return crow.Logger.setLevel(a,this.klass)};crow.Logger.setLevel=
function(b,e){var f=a[b.toLowerCase()];if("number"!==typeof f)throw Error("Invalid log level: "+b);e?e.LOG_LEVEL=f:c=f};crow.Logger.setAppender=function(a){b=a}})();crow.util.Assert={};crow.assert=function(a,b){if(!a)throw Error(b);};crow.assert.InvalidArgumentType=function(a){return"Invalid argument type, expected "+a};crow.assert.IncorrectArgumentCount=function(a,b){return"Incorrect argument count, got "+a+" but expected "+b};crow.assert.IndexOutBounds=function(a){return"Index out of bounds (<0 or >length), was "+a};crow.assert.AbstractMethod=function(a){return"Method "+a+" is abstract; must be overridden"};
crow.assert.IllegalMethodCall=function(a,b){return"Method `"+a+"` cannot be called here: "+b};crow.structs={};crow.structs.BucketPriorityQueue=function(a){this.arr=[];this.length=0;this.key_comparator=a?a:crow.structs.BucketPriorityQueue.DEFAULT_KEY_COMPARATOR};crow.structs.BucketPriorityQueue.DEFAULT_KEY_COMPARATOR=function(a,b){return a<b?-1:a>b?1:0};crow.structs.BucketPriorityQueue.REVERSE_KEY_COMPARATOR=function(a,b){return b<a?-1:b>a?1:0};crow.structs.BucketPriorityQueue.prototype.enqueue=function(a,b){this.findBucket(a,!0).push(b);this.length++};
crow.structs.BucketPriorityQueue.prototype.dequeue=function(){var a;if(this.length){var b=this.arr[0];a=b.shift();b.length||this.arr.shift();this.length--}return a};crow.structs.BucketPriorityQueue.prototype.contains=function(a,b){if(b)throw Error("not implemented yet");for(var c=0;c<this.arr.length;c++)for(var d=this.arr[c],e=0;e<d.length;e++)if(d[e]==a)return!0;return!1};
crow.structs.BucketPriorityQueue.prototype.getPriority=function(a){for(var b=0;b<this.arr.length;b++)for(var c=this.arr[b],d=0;d<c.length;d++)if(c[d]==a)return c.key;return null};crow.structs.BucketPriorityQueue.prototype.remove=function(a,b){if(b)throw Error("not implemented yet");for(var c=0;c<this.arr.length;c++)for(var d=this.arr[c],e=0;e<d.length;e++){var f=d[e];if(f==a)return d.splice(e,1),d.length||this.arr.splice(c,1),this.length--,f}};crow.structs.BucketPriorityQueue.prototype.peek=function(){if(this.length)return this.arr[0][0]};
crow.structs.BucketPriorityQueue.prototype.peekKey=function(){if(this.length)return this.arr[0].key};crow.structs.BucketPriorityQueue.prototype.each=function(a){for(var b=0;b<this.arr.length;b++){var c=this.arr[b];if(c)for(var d=0;d<c.length;d++)a(c[d],b)}};
crow.structs.BucketPriorityQueue.prototype.findBucket=function(a,b){for(var c,d=this.key_comparator,e=0,f=this.arr.length-1,g,h;e<=f;){g=e+Math.floor((f-e)/2);var k=this.arr[g];h=d(k.key,a);if(0>h)e=g+1;else if(0<h)f=g-1;else{c=k;break}}if(!c&&b){c=[];c.key=a;for(e=!1;g<this.arr.length&&!e;g++)0<d(this.arr[g].key,a)&&(this.arr.splice(g,0,c),e=!0);e||this.arr.push(c)}return c};crow.Algorithm=function(){};crow.Algorithm.wrapperNodeGetterTemplate=function(a){return function(b){if(b instanceof a)return b;var c=this.wrapperNode.get(b);if(c)return c;c=new a(b);c.algorithm=this;this.wrapperNode.set(b,c);return c}};crow.Algorithm.prototype._invalidatePoint=function(a,b){for(var c=b.x,d=b.y,e=0;e<a.nodes.length;e++){var f=a.nodes[e];if(f.x==c&&f.y==d){a.nodes=a.nodes.slice(0,1);a.end=null;a.found=!1;break}}};
crow.Algorithm.prototype._invalidateRegion=function(a,b){for(var c=b.x,d=b.y,e=c+b.dx,f=d+b.dy,g=0;g<a.nodes.length;g++){var h=a.nodes[g],k=h.x,h=h.y;if(k>=c&&h>=d&&k<e&&h<f){a.nodes=a.nodes.slice(0,1);a.end=null;a.found=!1;break}}};crow.Algorithm.prototype.continueCalculating=function(a,b){var c=a.nodes[a.nodes.length-1];c||(c=a.start);var d={};b&&(d.limit=b);a.actor&&(d.actor=a.actor);c=this.findPath(c,a.goal,d);a.nodes=a.nodes.concat(c.nodes.slice(1));a.found=c.found;return a.found};
crow.Algorithm.NodeMap=function(a){var b={};this.get=function(c){c=b[c.id];return"undefined"!==typeof c?c:a};this.set=function(a,d){b[a.id]=d}};crow.Algorithm.PriorityQueue=function(){throw Error("A PriorityQueue class is required, but none found!");};crow.Algorithm.initializeDataStructures=function(){crow.Algorithm.PriorityQueue=crow.structs.BucketPriorityQueue;crow.Algorithm.initializeDataStructures=function(){}};goog.disposable={};goog.disposable.IDisposable=function(){};goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(this.creationStack=Error().stack,goog.Disposable.instances_[goog.getUid(this)]=this)};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=0;goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var a=[],b;for(b in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(b)&&a.push(goog.Disposable.instances_[Number(b)]);return a};
goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;
goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var a=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(a))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[a]}};
goog.Disposable.prototype.registerDisposable=function(a){this.addOnDisposeCallback(goog.partial(goog.dispose,a))};goog.Disposable.prototype.addOnDisposeCallback=function(a,b){this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]);this.onDisposeCallbacks_.push(goog.bind(a,b))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};
goog.Disposable.isDisposed=function(a){return a&&"function"==typeof a.isDisposed?a.isDisposed():!1};goog.dispose=function(a){a&&"function"==typeof a.dispose&&a.dispose()};goog.disposeAll=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];goog.isArrayLike(d)?goog.disposeAll.apply(null,d):goog.dispose(d)}};goog.debug={};goog.debug.Error=function(a){Error.captureStackTrace?Error.captureStackTrace(this,goog.debug.Error):this.stack=Error().stack||"";a&&(this.message=String(a))};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.string={};goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};
goog.string.subs=function(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptySafe=function(a){return goog.string.isEmpty(goog.string.makeSafe(a))};goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};
goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};
goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};
goog.string.caseInsensitiveCompare=function(a,b){var c=String(a).toLowerCase(),d=String(b).toLowerCase();return c<d?-1:c==d?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;
goog.string.numerateCompare=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=a.toLowerCase().match(goog.string.numerateCompareRegExp_),d=b.toLowerCase().match(goog.string.numerateCompareRegExp_),e=Math.min(c.length,d.length),f=0;f<e;f++){var g=c[f],h=d[f];if(g!=h)return c=parseInt(g,10),!isNaN(c)&&(d=parseInt(h,10),!isNaN(d)&&c-d)?c-d:g<h?-1:1}return c.length!=d.length?c.length-d.length:a<b?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};
goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)return a.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;");if(!goog.string.allRe_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.amperRe_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.ltRe_,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.gtRe_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.quotRe_,"&quot;"));return a};
goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesUsingDom_=function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},c=document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,e){var f=b[a];if(f)return f;if("#"==e.charAt(0)){var g=Number("0"+e.substr(1));isNaN(g)||(f=String.fromCharCode(g))}f||(c.innerHTML=a+" ",f=c.firstChild.nodeValue.slice(0,-1));return b[a]=f})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if("#"==c.charAt(0)){var d=Number("0"+c.substr(1));if(!isNaN(d))return String.fromCharCode(d)}return a}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.stripQuotes=function(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,d){c&&(a=goog.string.unescapeEntities(a));if(d&&a.length>b){d>b&&(d=b);var e=a.length-d;a=a.substring(0,b-d)+"..."+a.substring(e)}else a.length>b&&(d=Math.floor(b/2),e=a.length-d,a=a.substring(0,d+b%2)+"..."+a.substring(e));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[d]||(31<e&&127>e?d:goog.string.escapeChar(d))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a,c=a.charCodeAt(0);if(31<c&&127>c)b=a;else{if(256>c){if(b="\\x",16>c||256<c)b+="0"}else b="\\u",4096>c&&(b+="0");b+=c.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=b};goog.string.toMap=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=!0;return b};
goog.string.contains=function(a,b){return-1!=a.indexOf(b)};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var d=a;0<=b&&(b<a.length&&0<c)&&(d=a.substr(0,b)+a.substr(b+c,a.length-b-c));return d};goog.string.remove=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"");return a.replace(c,"")};goog.string.removeAll=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"g");return a.replace(c,"")};
goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return Array(b+1).join(a)};goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};
goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){for(var c=0,d=goog.string.trim(String(a)).split("."),e=goog.string.trim(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&g<f;g++){var h=d[g]||"",k=e[g]||"",l=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var n=l.exec(h)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;var c=0==n[1].length?0:parseInt(n[1],10),q=0==p[1].length?0:parseInt(p[1],10),c=goog.string.compareElements_(c,q)||goog.string.compareElements_(0==
n[2].length,0==p[2].length)||goog.string.compareElements_(n[2],p[2])}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=goog.string.HASHCODE_MAX_;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmpty(a)?NaN:b};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(a,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(RegExp("(^"+(c?"|["+c+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()})};
goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.doAssertFailure_=function(a,b,c,d){var e="Assertion failed";if(c)var e=e+(": "+c),f=d;else a&&(e+=": "+a,f=b);throw new goog.asserts.AssertionError(""+e,f||[]);};
goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.fail=function(a,b){if(goog.asserts.ENABLE_ASSERTS)throw new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};
goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,d){goog.asserts.ENABLE_ASSERTS&&!(a instanceof b)&&goog.asserts.doAssertFailure_("instanceof check failed.",null,c,Array.prototype.slice.call(arguments,3));return a};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.peek=function(a){return a[a.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.indexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return!goog.isString(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return!goog.isString(b)||1!=b.length?-1:a.lastIndexOf(b,c);for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.forEach?function(a,b,c){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};goog.array.forEachRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;--d)d in e&&b.call(c,e[d],d,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.filter?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=goog.isString(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.map?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=goog.isString(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};goog.array.reduce=function(a,b,c,d){if(a.reduce)return d?a.reduce(goog.bind(b,d),c):a.reduce(b,c);var e=c;goog.array.forEach(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.reduceRight=function(a,b,c,d){if(a.reduceRight)return d?a.reduceRight(goog.bind(b,d),c):a.reduceRight(b,c);var e=c;goog.array.forEachRight(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.some?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.every?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};goog.array.count=function(a,b,c){var d=0;goog.array.forEach(a,function(a,f,g){b.call(c,a,f,g)&&++d},c);return d};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;d--)if(d in e&&b.call(c,e[d],d,a))return d;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var d;2==arguments.length||0>(d=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,d)};goog.array.remove=function(a,b){var c=goog.array.indexOf(a,b),d;(d=0<=c)&&goog.array.removeAt(a,c);return d};
goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};goog.array.clone=goog.array.toArray;
goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(goog.isArray(d)||(e=goog.isArrayLike(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,h=0;h<g;h++)a[f+h]=d[h];else a.push(d)}};goog.array.splice=function(a,b,c,d){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};
goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?goog.array.ARRAY_PROTOTYPE_.slice.call(a,b):goog.array.ARRAY_PROTOTYPE_.slice.call(a,b,c)};goog.array.removeDuplicates=function(a,b){for(var c=b||a,d={},e=0,f=0;f<a.length;){var g=a[f++],h=goog.isObject(g)?"o"+goog.getUid(g):(typeof g).charAt(0)+g;Object.prototype.hasOwnProperty.call(d,h)||(d[h]=!0,c[e++]=g)}c.length=e};
goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};goog.array.binarySearch_=function(a,b,c,d,e){for(var f=0,g=a.length,h;f<g;){var k=f+g>>1,l;l=c?b.call(e,a[k],k,a):b(d,a[k]);0<l?f=k+1:(g=k,h=!l)}return h?f:~f};goog.array.sort=function(a,b){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.sort.call(a,b||goog.array.defaultCompare)};
goog.array.stableSort=function(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||goog.array.defaultCompare;goog.array.sort(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value};goog.array.sortObjectsByKey=function(a,b,c){var d=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return d(a[b],c[b])})};
goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var d=1;d<a.length;d++){var e=b(a[d-1],a[d]);if(0<e||0==e&&c)return!1}return!0};goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var d=a.length;c=c||goog.array.defaultCompareEquality;for(var e=0;e<d;e++)if(!c(a[e],b[e]))return!1;return!0};goog.array.compare=function(a,b,c){return goog.array.equals(a,b,c)};
goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var d=Math.min(a.length,b.length),e=0;e<d;e++){var f=c(a[e],b[e]);if(0!=f)return f}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};
goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};goog.array.bucket=function(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d],f=b(e,d,a);goog.isDef(f)&&(c[f]||(c[f]=[])).push(e)}return c};goog.array.toObject=function(a,b,c){var d={};goog.array.forEach(a,function(e,f){d[b.call(c,e,f,a)]=e});return d};
goog.array.range=function(a,b,c){var d=[],e=0,f=a;c=c||1;void 0!==b&&(e=a,f=b);if(0>c*(f-e))return[];if(0<c)for(a=e;a<f;a+=c)d.push(a);else for(a=e;a>f;a+=c)d.push(a);return d};goog.array.repeat=function(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];goog.isArray(d)?b.push.apply(b,goog.array.flatten.apply(null,d)):b.push(d)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?goog.array.ARRAY_PROTOTYPE_.unshift.apply(a,a.splice(-b,b)):0>b&&goog.array.ARRAY_PROTOTYPE_.push.apply(a,a.splice(0,-b)));return a};goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=0;;c++){for(var d=[],e=0;e<arguments.length;e++){var f=arguments[e];if(c>=f.length)return b;d.push(f[c])}b.push(d)}};
goog.array.shuffle=function(a,b){for(var c=b||Math.random,d=a.length-1;0<d;d--){var e=Math.floor(c()*(d+1)),f=a[d];a[d]=a[e];a[e]=f}};goog.debug.entryPointRegistry={};goog.debug.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(a){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=a;if(goog.debug.entryPointRegistry.monitorsMayExist_)for(var b=goog.debug.entryPointRegistry.monitors_,c=0;c<b.length;c++)a(goog.bind(b[c].wrap,b[c]))};
goog.debug.entryPointRegistry.monitorAll=function(a){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var b=goog.bind(a.wrap,a),c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](b);goog.debug.entryPointRegistry.monitors_.push(a)};
goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(a){var b=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(a==b[b.length-1],"Only the most recent monitor can be unwrapped.");a=goog.bind(a.unwrap,a);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](a);b.length--};goog.debug.errorHandlerWeakDep={protectEntryPoint:function(a,b){return a}};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;
goog.userAgent.getUserAgentString=function(){return goog.global.navigator?goog.global.navigator.userAgent:null};goog.userAgent.getNavigator=function(){return goog.global.navigator};
goog.userAgent.init_=function(){goog.userAgent.detectedOpera_=!1;goog.userAgent.detectedIe_=!1;goog.userAgent.detectedWebkit_=!1;goog.userAgent.detectedMobile_=!1;goog.userAgent.detectedGecko_=!1;var a;if(!goog.userAgent.BROWSER_KNOWN_&&(a=goog.userAgent.getUserAgentString())){var b=goog.userAgent.getNavigator();goog.userAgent.detectedOpera_=0==a.indexOf("Opera");goog.userAgent.detectedIe_=!goog.userAgent.detectedOpera_&&-1!=a.indexOf("MSIE");goog.userAgent.detectedWebkit_=!goog.userAgent.detectedOpera_&&
-1!=a.indexOf("WebKit");goog.userAgent.detectedMobile_=goog.userAgent.detectedWebkit_&&-1!=a.indexOf("Mobile");goog.userAgent.detectedGecko_=!goog.userAgent.detectedOpera_&&!goog.userAgent.detectedWebkit_&&"Gecko"==b.product}};goog.userAgent.BROWSER_KNOWN_||goog.userAgent.init_();goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.userAgent.detectedOpera_;goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.userAgent.detectedIe_;
goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.userAgent.detectedGecko_;goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.userAgent.detectedWebkit_;goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.detectedMobile_;goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};
goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD;
goog.userAgent.initPlatform_=function(){goog.userAgent.detectedMac_=goog.string.contains(goog.userAgent.PLATFORM,"Mac");goog.userAgent.detectedWindows_=goog.string.contains(goog.userAgent.PLATFORM,"Win");goog.userAgent.detectedLinux_=goog.string.contains(goog.userAgent.PLATFORM,"Linux");goog.userAgent.detectedX11_=!!goog.userAgent.getNavigator()&&goog.string.contains(goog.userAgent.getNavigator().appVersion||"","X11");var a=goog.userAgent.getUserAgentString();goog.userAgent.detectedAndroid_=!!a&&
0<=a.indexOf("Android");goog.userAgent.detectedIPhone_=!!a&&0<=a.indexOf("iPhone");goog.userAgent.detectedIPad_=!!a&&0<=a.indexOf("iPad")};goog.userAgent.PLATFORM_KNOWN_||goog.userAgent.initPlatform_();goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.userAgent.detectedMac_;goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.userAgent.detectedWindows_;
goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.detectedLinux_;goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.detectedX11_;goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.userAgent.detectedAndroid_;goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.userAgent.detectedIPhone_;
goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.userAgent.detectedIPad_;
goog.userAgent.determineVersion_=function(){var a="",b;goog.userAgent.OPERA&&goog.global.opera?(a=goog.global.opera.version,a="function"==typeof a?a():a):(goog.userAgent.GECKO?b=/rv\:([^\);]+)(\)|;)/:goog.userAgent.IE?b=/MSIE\s+([^\);]+)(\)|;)/:goog.userAgent.WEBKIT&&(b=/WebKit\/(\S+)/),b&&(a=(a=b.exec(goog.userAgent.getUserAgentString()))?a[1]:""));return goog.userAgent.IE&&(b=goog.userAgent.getDocumentMode_(),b>parseFloat(a))?String(b):a};
goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(a,b){return goog.string.compareVersions(a,b)};goog.userAgent.isVersionCache_={};goog.userAgent.isVersion=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionCache_[a]||(goog.userAgent.isVersionCache_[a]=0<=goog.string.compareVersions(goog.userAgent.VERSION,a))};
goog.userAgent.isDocumentMode=function(a){return goog.userAgent.IE&&goog.userAgent.DOCUMENT_MODE>=a};goog.userAgent.DOCUMENT_MODE=function(){var a=goog.global.document;return!a||!goog.userAgent.IE?void 0:goog.userAgent.getDocumentMode_()||("CSS1Compat"==a.compatMode?parseInt(goog.userAgent.VERSION,10):5)}();goog.events={};
goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersion("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersion("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersion("8")||goog.userAgent.OPERA&&goog.userAgent.isVersion("9.5")||
goog.userAgent.WEBKIT&&goog.userAgent.isVersion("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersion("8")||goog.userAgent.IE&&!goog.userAgent.isVersion("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!(!goog.global.document||!(document.documentElement&&"ontouchstart"in document.documentElement))||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints)};goog.events.Event=function(a,b){this.type=a;this.currentTarget=this.target=b};goog.events.Event.prototype.disposeInternal=function(){};goog.events.Event.prototype.dispose=function(){};goog.events.Event.prototype.propagationStopped_=!1;goog.events.Event.prototype.defaultPrevented=!1;goog.events.Event.prototype.returnValue_=!0;goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};
goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(a){a.stopPropagation()};goog.events.Event.preventDefault=function(a){a.preventDefault()};goog.events.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",
DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONTEXTMENU:"contextmenu",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",
CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",TRANSITIONEND:goog.userAgent.WEBKIT?"webkitTransitionEnd":goog.userAgent.OPERA?"oTransitionEnd":"transitionend",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",
MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROVER:"MSPointerOver",MSPOINTEROUT:"MSPointerOut",MSPOINTERUP:"MSPointerUp",TEXTINPUT:"textinput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend"};goog.reflect={};goog.reflect.object=function(a,b){return b};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(a,b){try{return goog.reflect.sinkValue(a[b]),!0}catch(c){}return!1};goog.events.BrowserEvent=function(a,b){a&&this.init(a,b)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.target=null;goog.events.BrowserEvent.prototype.relatedTarget=null;goog.events.BrowserEvent.prototype.offsetX=0;goog.events.BrowserEvent.prototype.offsetY=0;goog.events.BrowserEvent.prototype.clientX=0;
goog.events.BrowserEvent.prototype.clientY=0;goog.events.BrowserEvent.prototype.screenX=0;goog.events.BrowserEvent.prototype.screenY=0;goog.events.BrowserEvent.prototype.button=0;goog.events.BrowserEvent.prototype.keyCode=0;goog.events.BrowserEvent.prototype.charCode=0;goog.events.BrowserEvent.prototype.ctrlKey=!1;goog.events.BrowserEvent.prototype.altKey=!1;goog.events.BrowserEvent.prototype.shiftKey=!1;goog.events.BrowserEvent.prototype.metaKey=!1;
goog.events.BrowserEvent.prototype.platformModifierKey=!1;goog.events.BrowserEvent.prototype.event_=null;
goog.events.BrowserEvent.prototype.init=function(a,b){var c=this.type=a.type;goog.events.Event.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;d?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(d,"nodeName")||(d=null)):c==goog.events.EventType.MOUSEOVER?d=a.fromElement:c==goog.events.EventType.MOUSEOUT&&(d=a.toElement);this.relatedTarget=d;this.offsetX=goog.userAgent.WEBKIT||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=goog.userAgent.WEBKIT||void 0!==
a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.platformModifierKey=goog.userAgent.MAC?a.metaKey:a.ctrlKey;this.state=a.state;this.event_=a;a.defaultPrevented&&this.preventDefault();
delete this.propagationStopped_};goog.events.BrowserEvent.prototype.isButton=function(a){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==a:"click"==this.type?a==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[a])};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};
goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};
goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var a=this.event_;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.prototype.disposeInternal=function(){};goog.events.EventWrapper=function(){};goog.events.EventWrapper.prototype.listen=function(a,b,c,d,e){};goog.events.EventWrapper.prototype.unlisten=function(a,b,c,d,e){};goog.events.Listenable=function(){};goog.events.Listenable.USE_LISTENABLE_INTERFACE=!1;goog.events.Listenable.IMPLEMENTED_BY_PROP_="__closure_listenable";goog.events.Listenable.addImplementation=function(a){a.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP_]=!0};goog.events.Listenable.isImplementedBy=function(a){return!(!a||!a[goog.events.Listenable.IMPLEMENTED_BY_PROP_])};goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.Listener=function(){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack)};goog.events.Listener.ENABLE_MONITORING=!1;goog.events.Listener.prototype.key=0;goog.events.Listener.prototype.removed=!1;goog.events.Listener.prototype.callOnce=!1;
goog.events.Listener.prototype.init=function(a,b,c,d,e,f){if(goog.isFunction(a))this.isFunctionListener_=!0;else if(a&&a.handleEvent&&goog.isFunction(a.handleEvent))this.isFunctionListener_=!1;else throw Error("Invalid listener argument");this.listener=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.handler=f;this.callOnce=!1;this.key=goog.events.ListenableKey.reserveKey();this.removed=!1};
goog.events.Listener.prototype.handleEvent=function(a){return this.isFunctionListener_?this.listener.call(this.handler||this.src,a):this.listener.handleEvent.call(this.listener,a)};goog.object={};goog.object.forEach=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)};goog.object.filter=function(a,b,c){var d={},e;for(e in a)b.call(c,a[e],e,a)&&(d[e]=a[e]);return d};goog.object.map=function(a,b,c){var d={},e;for(e in a)d[e]=b.call(c,a[e],e,a);return d};goog.object.some=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return!0;return!1};goog.object.every=function(a,b,c){for(var d in a)if(!b.call(c,a[d],d,a))return!1;return!0};
goog.object.getCount=function(a){var b=0,c;for(c in a)b++;return b};goog.object.getAnyKey=function(a){for(var b in a)return b};goog.object.getAnyValue=function(a){for(var b in a)return a[b]};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b};goog.object.getKeys=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};
goog.object.getValueByKeys=function(a,b){for(var c=goog.isArrayLike(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!goog.isDef(a));c++);return a};goog.object.containsKey=function(a,b){return b in a};goog.object.containsValue=function(a,b){for(var c in a)if(a[c]==b)return!0;return!1};goog.object.findKey=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d};goog.object.findValue=function(a,b,c){return(b=goog.object.findKey(a,b,c))&&a[b]};
goog.object.isEmpty=function(a){for(var b in a)return!1;return!0};goog.object.clear=function(a){for(var b in a)delete a[b]};goog.object.remove=function(a,b){var c;(c=b in a)&&delete a[b];return c};goog.object.add=function(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');goog.object.set(a,b,c)};goog.object.get=function(a,b,c){return b in a?a[b]:c};goog.object.set=function(a,b,c){a[b]=c};goog.object.setIfUndefined=function(a,b,c){return b in a?a[b]:a[b]=c};
goog.object.clone=function(a){var b={},c;for(c in a)b[c]=a[c];return b};goog.object.unsafeClone=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.object.unsafeClone(a[c]);return b}return a};goog.object.transpose=function(a){var b={},c;for(c in a)b[a[c]]=c;return b};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.object.extend=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<goog.object.PROTOTYPE_FIELDS_.length;f++)c=goog.object.PROTOTYPE_FIELDS_[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};
goog.object.create=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};goog.object.createSet=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};
goog.object.createImmutableView=function(a){var b=a;Object.isFrozen&&!Object.isFrozen(a)&&(b=Object.create(a),Object.freeze(b));return b};goog.object.isImmutableView=function(a){return!!Object.isFrozen&&Object.isFrozen(a)};goog.events.listeners_={};goog.events.listenerTree_={};goog.events.sources_={};goog.events.onString_="on";goog.events.onStringMap_={};goog.events.keySeparator_="_";
goog.events.listen=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listen(a,b[f],c,d,e);return null}a=goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.listen(b,goog.events.wrapListener_(c),d,e):goog.events.listen_(a,b,c,!1,d,e);b=a.key;goog.events.listeners_[b]=a;return b};
goog.events.listen_=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=goog.events.listenerTree_;b in g||(g[b]={count_:0,remaining_:0});g=g[b];e in g||(g[e]={count_:0,remaining_:0},g.count_++);var g=g[e],h=goog.getUid(a),k;g.remaining_++;if(g[h]){k=g[h];for(var l=0;l<k.length;l++)if(g=k[l],g.listener==c&&g.handler==f){if(g.removed)break;d||(k[l].callOnce=!1);return k[l]}}else k=g[h]=[],g.count_++;l=goog.events.getProxy();g=new goog.events.Listener;g.init(c,l,a,b,e,f);g.callOnce=
d;l.src=a;l.listener=g;k.push(g);goog.events.sources_[h]||(goog.events.sources_[h]=[]);goog.events.sources_[h].push(g);a.addEventListener?(a==goog.global||!a.customEvent_)&&a.addEventListener(b,l,e):a.attachEvent(goog.events.getOnString_(b),l);return g};goog.events.getProxy=function(){var a=goog.events.handleBrowserEvent_,b=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b};
goog.events.listenOnce=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listenOnce(a,b[f],c,d,e);return null}a=goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.listenOnce(b,goog.events.wrapListener_(c),d,e):goog.events.listen_(a,b,c,!0,d,e);b=a.key;goog.events.listeners_[b]=a;return b};goog.events.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e)};
goog.events.unlisten=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.unlisten(a,b[f],c,d,e);return null}if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.unlisten(b,goog.events.wrapListener_(c),d,e);d=!!d;a=goog.events.getListeners_(a,b,d);if(!a)return!1;for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].handler==e)return goog.events.unlistenByKey(a[f].key);return!1};
goog.events.unlistenByKey=function(a){var b=goog.events.listeners_[a];if(!b||b.removed)return!1;var c=b.src;if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(c))return c.unlistenByKey(b);var d=b.type,e=b.proxy,f=b.capture;c.removeEventListener?(c==goog.global||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(goog.events.getOnString_(d),e);c=goog.getUid(c);goog.events.sources_[c]&&(e=goog.events.sources_[c],goog.array.remove(e,b),
0==e.length&&delete goog.events.sources_[c]);b.removed=!0;if(b=goog.events.listenerTree_[d][f][c])b.needsCleanup_=!0,goog.events.cleanUp_(d,f,c,b);delete goog.events.listeners_[a];return!0};goog.events.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e)};goog.events.cleanUp=function(a){delete goog.events.listeners_[a.key]};
goog.events.cleanUp_=function(a,b,c,d){if(!d.locked_&&d.needsCleanup_){for(var e=0,f=0;e<d.length;e++)d[e].removed?d[e].proxy.src=null:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.needsCleanup_=!1;0==f&&(delete goog.events.listenerTree_[a][b][c],goog.events.listenerTree_[a][b].count_--,0==goog.events.listenerTree_[a][b].count_&&(delete goog.events.listenerTree_[a][b],goog.events.listenerTree_[a].count_--),0==goog.events.listenerTree_[a].count_&&delete goog.events.listenerTree_[a])}};
goog.events.removeAll=function(a,b){var c=0,d=null==b;if(null!=a){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&a&&goog.events.Listenable.isImplementedBy(a))return a.removeAllListeners(b);var e=goog.getUid(a);if(goog.events.sources_[e])for(var e=goog.events.sources_[e],f=e.length-1;0<=f;f--){var g=e[f];if(d||b==g.type)goog.events.unlistenByKey(g.key),c++}}else goog.object.forEach(goog.events.listeners_,function(a,b){goog.events.unlistenByKey(b);c++});return c};
goog.events.getListeners=function(a,b,c){return goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.getListeners(b,c):goog.events.getListeners_(a,b,c)||[]};goog.events.getListeners_=function(a,b,c){var d=goog.events.listenerTree_;return b in d&&(d=d[b],c in d&&(d=d[c],a=goog.getUid(a),d[a]))?d[a]:null};
goog.events.getListener=function(a,b,c,d,e){d=!!d;if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.getListener(b,goog.events.wrapListener_(c),d,e);if(a=goog.events.getListeners_(a,b,d))for(b=0;b<a.length;b++)if(!a[b].removed&&a[b].listener==c&&a[b].capture==d&&a[b].handler==e)return a[b];return null};
goog.events.hasListener=function(a,b,c){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.hasListener(b,c);a=goog.getUid(a);var d=goog.events.sources_[a];if(d){var e=goog.isDef(b),f=goog.isDef(c);return e&&f?(d=goog.events.listenerTree_[b],!!d&&!!d[c]&&a in d[c]):!e&&!f?!0:goog.array.some(d,function(a){return e&&a.type==b||f&&a.capture==c})}return!1};
goog.events.expose=function(a){var b=[],c;for(c in a)a[c]&&a[c].id?b.push(c+" = "+a[c]+" ("+a[c].id+")"):b.push(c+" = "+a[c]);return b.join("\n")};goog.events.getOnString_=function(a){return a in goog.events.onStringMap_?goog.events.onStringMap_[a]:goog.events.onStringMap_[a]=goog.events.onString_+a};
goog.events.fireListeners=function(a,b,c,d){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.fireListeners(b,c,d);var e=goog.events.listenerTree_;return b in e&&(e=e[b],c in e)?goog.events.fireListeners_(e[c],a,b,c,d):!0};
goog.events.fireListeners_=function(a,b,c,d,e){var f=1;b=goog.getUid(b);if(a[b]){var g=--a.remaining_,h=a[b];h.locked_?h.locked_++:h.locked_=1;try{for(var k=h.length,l=0;l<k;l++){var m=h[l];m&&!m.removed&&(f&=!1!==goog.events.fireListener(m,e))}}finally{a.remaining_=Math.max(g,a.remaining_),h.locked_--,goog.events.cleanUp_(c,d,b,h)}}return Boolean(f)};goog.events.fireListener=function(a,b){a.callOnce&&goog.events.unlistenByKey(a.key);return a.handleEvent(b)};goog.events.getTotalListenerCount=function(){return goog.object.getCount(goog.events.listeners_)};
goog.events.dispatchEvent=function(a,b){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE)return a.dispatchEvent(b);var c=b.type||b,d=goog.events.listenerTree_;if(!(c in d))return!0;if(goog.isString(b))b=new goog.events.Event(b,a);else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(c,a);goog.object.extend(b,e)}var e=1,f,d=d[c],c=!0 in d,g;if(c){f=[];for(g=a;g;g=g.getParentEventTarget())f.push(g);g=d[!0];g.remaining_=g.count_;for(var h=f.length-1;!b.propagationStopped_&&
0<=h&&g.remaining_;h--)b.currentTarget=f[h],e&=goog.events.fireListeners_(g,f[h],b.type,!0,b)&&!1!=b.returnValue_}if(!1 in d)if(g=d[!1],g.remaining_=g.count_,c)for(h=0;!b.propagationStopped_&&h<f.length&&g.remaining_;h++)b.currentTarget=f[h],e&=goog.events.fireListeners_(g,f[h],b.type,!1,b)&&!1!=b.returnValue_;else for(d=a;!b.propagationStopped_&&d&&g.remaining_;d=d.getParentEventTarget())b.currentTarget=d,e&=goog.events.fireListeners_(g,d,b.type,!1,b)&&!1!=b.returnValue_;return Boolean(e)};
goog.events.protectBrowserEventEntryPoint=function(a){goog.events.handleBrowserEvent_=a.protectEntryPoint(goog.events.handleBrowserEvent_)};
goog.events.handleBrowserEvent_=function(a,b){if(a.removed)return!0;var c=a.type,d=goog.events.listenerTree_;if(!(c in d))return!0;var d=d[c],e,f;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){e=b||goog.getObjectByName("window.event");var g=!0 in d,h=!1 in d;if(g){if(goog.events.isMarkedIeEvent_(e))return!0;goog.events.markIeEvent_(e)}var k=new goog.events.BrowserEvent;k.init(e,this);e=!0;try{if(g){for(var l=[],m=k.currentTarget;m;m=m.parentNode)l.push(m);f=d[!0];f.remaining_=f.count_;for(var n=
l.length-1;!k.propagationStopped_&&0<=n&&f.remaining_;n--)k.currentTarget=l[n],e&=goog.events.fireListeners_(f,l[n],c,!0,k);if(h){f=d[!1];f.remaining_=f.count_;for(n=0;!k.propagationStopped_&&n<l.length&&f.remaining_;n++)k.currentTarget=l[n],e&=goog.events.fireListeners_(f,l[n],c,!1,k)}}else e=goog.events.fireListener(a,k)}finally{l&&(l.length=0)}return e}c=new goog.events.BrowserEvent(b,this);return e=goog.events.fireListener(a,c)};
goog.events.markIeEvent_=function(a){var b=!1;if(0==a.keyCode)try{a.keyCode=-1;return}catch(c){b=!0}if(b||void 0==a.returnValue)a.returnValue=!0};goog.events.isMarkedIeEvent_=function(a){return 0>a.keyCode||void 0!=a.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(a){return a+"_"+goog.events.uniqueIdCounter_++};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1E9*Math.random()>>>0);
goog.events.wrapListener_=function(a){return goog.isFunction(a)?a:a[goog.events.LISTENER_WRAPPER_PROP_]||(a[goog.events.LISTENER_WRAPPER_PROP_]=function(b){return a.handleEvent(b)})};goog.debug.entryPointRegistry.register(function(a){goog.events.handleBrowserEvent_=a(goog.events.handleBrowserEvent_)});goog.events.EventTarget=function(){goog.Disposable.call(this);goog.events.Listenable.USE_LISTENABLE_INTERFACE&&(this.eventTargetListeners_={},this.reallyDisposed_=!1,this.actualEventTarget_=this)};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.prototype.customEvent_=!0;goog.events.EventTarget.prototype.parentEventTarget_=null;
goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(a){this.parentEventTarget_=a};goog.events.EventTarget.prototype.addEventListener=function(a,b,c,d){goog.events.listen(this,a,b,c,d)};goog.events.EventTarget.prototype.removeEventListener=function(a,b,c,d){goog.events.unlisten(this,a,b,c,d)};
goog.events.EventTarget.prototype.dispatchEvent=function(a){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE){if(this.reallyDisposed_)return!0;var b,c=this.getParentEventTarget();if(c)for(b=[];c;c=c.getParentEventTarget())b.push(c);return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,a,b)}return goog.events.dispatchEvent(this,a)};
goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);goog.events.Listenable.USE_LISTENABLE_INTERFACE?(this.removeAllListeners(),this.reallyDisposed_=!0):goog.events.removeAll(this);this.parentEventTarget_=null};
goog.events.Listenable.USE_LISTENABLE_INTERFACE&&(goog.events.EventTarget.prototype.listen=function(a,b,c,d){return this.listenInternal_(a,b,!1,c,d)},goog.events.EventTarget.prototype.listenOnce=function(a,b,c,d){return this.listenInternal_(a,b,!0,c,d)},goog.events.EventTarget.prototype.listenInternal_=function(a,b,c,d,e){goog.asserts.assert(!this.reallyDisposed_,"Can not listen on disposed object.");var f=this.eventTargetListeners_[a]||(this.eventTargetListeners_[a]=[]),g;g=goog.events.EventTarget.findListenerIndex_(f,
b,d,e);if(-1<g)return g=f[g],c||(g.callOnce=!1),g;g=new goog.events.Listener;g.init(b,null,this,a,!!d,e);g.callOnce=c;f.push(g);return g},goog.events.EventTarget.prototype.unlisten=function(a,b,c,d){if(!(a in this.eventTargetListeners_))return!1;a=this.eventTargetListeners_[a];b=goog.events.EventTarget.findListenerIndex_(a,b,c,d);return-1<b?(c=a[b],goog.events.cleanUp(c),c.removed=!0,goog.array.removeAt(a,b)):!1},goog.events.EventTarget.prototype.unlistenByKey=function(a){var b=a.type;if(!(b in this.eventTargetListeners_))return!1;
if(b=goog.array.remove(this.eventTargetListeners_[b],a))goog.events.cleanUp(a),a.removed=!0;return b},goog.events.EventTarget.prototype.removeAllListeners=function(a,b){var c=0,d;for(d in this.eventTargetListeners_)if(!a||d==a){for(var e=this.eventTargetListeners_[d],f=0;f<e.length;f++)++c,goog.events.cleanUp(e[f]),e[f].removed=!0;e.length=0}return c},goog.events.EventTarget.prototype.fireListeners=function(a,b,c){goog.asserts.assert(!this.reallyDisposed_,"Can not fire listeners after dispose() completed.");
if(!(a in this.eventTargetListeners_))return!0;var d=!0;a=goog.array.clone(this.eventTargetListeners_[a]);for(var e=0;e<a.length;++e){var f=a[e];f&&(!f.removed&&f.capture==b)&&(f.callOnce&&this.unlistenByKey(f),d=!1!==f.handleEvent(c)&&d)}return d&&!1!=c.returnValue_},goog.events.EventTarget.prototype.getListeners=function(a,b){var c=this.eventTargetListeners_[a],d=[];if(c)for(var e=0;e<c.length;++e){var f=c[e];f.capture==b&&d.push(f)}return d},goog.events.EventTarget.prototype.getListener=function(a,
b,c,d){a=this.eventTargetListeners_[a];var e=-1;a&&(e=goog.events.EventTarget.findListenerIndex_(a,b,c,d));return-1<e?a[e]:null},goog.events.EventTarget.prototype.hasListener=function(a,b){var c=goog.isDef(a),d=goog.isDef(b);return goog.object.some(this.eventTargetListeners_,function(e,f){for(var g=0;g<e.length;++g)if((!c||e[g].type==a)&&(!d||e[g].capture==b))return!0;return!1})},goog.events.EventTarget.prototype.setTargetForTesting=function(a){this.actualEventTarget_=a},goog.events.EventTarget.dispatchEventInternal_=
function(a,b,c){var d=b.type||b;if(goog.isString(b))b=new goog.events.Event(b,a);else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(d,a);goog.object.extend(b,e)}var e=!0,f;if(c)for(var g=c.length-1;!b.propagationStopped_&&0<=g;g--)f=b.currentTarget=c[g],e=f.fireListeners(d,!0,b)&&e;b.propagationStopped_||(f=b.currentTarget=a,e=f.fireListeners(d,!0,b)&&e,b.propagationStopped_||(e=f.fireListeners(d,!1,b)&&e));if(c)for(g=0;!b.propagationStopped_&&g<c.length;g++)f=
b.currentTarget=c[g],e=f.fireListeners(d,!1,b)&&e;return e},goog.events.EventTarget.findListenerIndex_=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(f.listener==b&&f.capture==!!c&&f.handler==d)return e}return-1});crow.Graph=function(){this.nodes=[];this.map={};this.version="0";this.validator=new goog.events.EventTarget;this.height=this.width=0;this.addNode=function(a){a._initialize();if(a.getX&&a.getY){var b=a.getX(),c=a.getY();b+1>this.width&&(this.width=b+1);c+1>this.height&&(this.height=c+1)}this.nodes.push(a);this.map[a.id]=a};this.removeNode=function(a,b,c){if("number"===typeof a){delete this.map[""+a+"_"+b];for(var d=0;d<this.nodes.length;d++){var e=this.nodes[d];if(e.x==a&&e.y==b){this.nodes.splice(d,
1);break}}c&&this.invalidate(a,b)}else delete this.map[a.id]};this.getNode=function(a,b,c){var d;if("function"===typeof a)for(var e=0;e<this.nodes.length;e++){var f=this.nodes[e];if(a.call(f)){d=f;break}}else{if("string"===typeof a)return this.map[a];if("number"!==typeof a)throw Error("x coordinate not provided");if("number"!==typeof b)throw Error("y coordinate not provided");d=this.map[""+a+"_"+b]}if(d)return d;if(c&&"number"===typeof a)return d=new crow.BaseNode([a,b]),d.isBlank=!0,d};this.getNodes=
function(a){switch(typeof a){case "function":return this.getNodes({filter:a});case "object":var b=a.start||this.nodes[0],c=crow.Graph._lookupAlgorithm(a.algorithm||"linear");if(!(c.prototype instanceof crow.algorithm.SearchAlgorithm))throw Error("only compatible with SearchAlgorithms");return(new c(this)).search(b,{filter:a.filter});case "undefined":return this.nodes;default:throw Error("unsupported object "+a.toString());}};this.findGoal=function(a){return crow.Graph.findGoal(a,this)};this.invalidate=
function(a,b,c,d){if(0==c||0==d)throw Error("dx and dy can't be 0");c&&d?this.validator.dispatchEvent({type:"invalidateRegion",x:a,y:b,dx:c,dy:d}):this.validator.dispatchEvent({type:"invalidatePoint",x:a,y:b})}};
crow.Graph.findGoal=function(a,b){crow.Algorithm.initializeDataStructures();var c=a.start||b&&b.nodes[0];if(!c)throw Error("To go somewhere you must know where you start...perhaps you meant to provide a start node?");var d=a.goal,e=crow.Graph._lookupAlgorithm(a.algorithm)||crow.AlgorithmResolver.getAlgorithm();if(!(e.prototype instanceof crow.algorithm.ShortestPathAlgorithm))throw Error("only compatible with ShortestPathAlgorithms");a.graph=b;return(new e(b)).findPath(c,d,a)};
crow.Graph.algorithm={};crow.Graph.defaultAlgorithm={};crow.Graph.fromTilePlane=function(a,b){if(!window.Effect||!window.Effect.Port)throw Error("EffectGames-specific extensions don't work anywhere else");if(!a)throw Error("tplane is required");if("function"!==typeof b)throw Error("callback not provided or not a function");for(var c=new crow.Graph,d=0,e=a.getMaxTileX();d<e;d++)for(var f=0,g=a.getMaxTileY();f<g;f++){var h=a.lookupTile(d,f),k=a.lookupTile(d,f,!0);(h=b(h,k))&&c.addNode(h)}return c};
crow.Graph.fromArray=function(a,b){crow.assert(a instanceof Array,crow.assert.InvalidArgumentType("Array"));for(var c=new crow.Graph,d,e=0,f=0;f<a.length;f++){d=0;for(var g=a[f],h=0;h<g.length;h++){var k=g.charAt(h);(k=b(d,e,k))&&c.addNode(k);d++}e++}return c};crow.Graph.registerAlgorithm=function(a){var b=a.alias;if(!b)throw Error("No alias found for algorithm");crow.Graph.algorithm[b]=a};
crow.Graph._lookupAlgorithm=function(a){var b=typeof a;if("string"===b){if(b=crow.Graph.algorithm[a])return b;throw Error("Algorithm `"+a+"` not found");}if("object"===b||"undefined"===b)if(b=crow.AlgorithmResolver.getAlgorithm(a))return b;return null};crow.GraphUtil={distance:{euclidean:function(a,b){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2))},manhattan:function(a,b){return Math.abs(a)+Math.abs(b)},chebyshev:function(a,b){return Math.max(Math.abs(a),Math.abs(b))},one:function(){return 1}}};
crow.GraphUtil.distance.pythagoras=crow.GraphUtil.distance.euclidean;crow.GraphUtil.distance.maximum=crow.GraphUtil.distance.chebyshev;crow.GraphUtil.distance.manhattan8=crow.GraphUtil.distance.chebyshev;crow.AlgorithmResolver=new function(){this.getAlgorithm=function(a){return this.getAlgorithms(a).dequeue()};this.getAlgorithms=function(a){a||(a={});"undefined"===typeof a.heuristics_allowed&&(a.heuristics_allowed=!0);var b=crow.Graph.algorithm,c=new crow.structs.BucketPriorityQueue(crow.structs.BucketPriorityQueue.REVERSE_KEY_COMPARATOR),d;for(d in b){var e=b[d],f=e.attributes;if(f){var g=0,g="undefined"!==typeof a.min_speed&&a.min_speed>f.min_speed?g-Infinity:g+f.min_speed;if(a.moving_start&&!f.moving_start||
a.moving_goal&&!f.moving_goal||a.unstable_graph&&!f.unstable_graph||!a.heuristics_allowed&&f.heuristics_allowed||a.goal_is_node&&!f.goal_is_node||a.goal_is_callback&&!f.goal_is_callback)g-=Infinity;-Infinity<g&&c.enqueue(g,e)}}return c}};crow.algorithm={};crow.algorithm.ShortestPathAlgorithm=function(){};crow.algorithm.ShortestPathAlgorithm.prototype=new crow.Algorithm;crow.algorithm.ShortestPathAlgorithm.prototype.findPath=function(a,b,c){this.wrapperNode=new crow.Algorithm.NodeMap};crow.Node=function(a){a||(a=""+Math.random());this.id=a};crow.Node.prototype.distanceAlgorithm=crow.GraphUtil.distance.manhattan;crow.Node.prototype.distanceToGoal=function(){throw Error("This method (either distanceToGoal or distanceToNeighbor) was called, but is not implemented.  You must override this method in your own class to determine the distance between nodes.");};crow.Node.prototype.distanceToNeighbor=function(){throw Error("distanceToNeighbor must be overridden");};
crow.Node.prototype.getNeighbors=function(a){throw Error("This method (getNeighbors) was called, but is not implemented.  You need to implement it so that the algorithm knows how to find the nodes reachable from the current node.");};crow.GridNode=function(a){crow.Node.apply(this);a&&(this.x=a[0],this.y=a[1]);this._initialized=this.isBlank=!1};crow.GridNode.prototype=new crow.Node;
crow.GridNode.prototype._initialize=function(){if(!this._initialized){this._initialized=!0;var a=this.getX(),b=this.getY();if("number"!==typeof a)throw Error("Node must have a valid x coord");if("number"!==typeof b)throw Error("Node must have a valid y coord");a=Math.floor(a);b=Math.floor(b);this.x=a;this.y=b;this.generateId();delete this.getX;delete this.getY;this.distanceToNeighbor==crow.Node.prototype.distanceToNeighbor&&(this.distanceToNeighbor=this.distanceToGoal)}};
crow.GridNode.prototype.getX=function(){return this.x};crow.GridNode.prototype.getY=function(){return this.y};crow.GridNode.prototype.distanceToGoal=function(a,b){return this.distanceAlgorithm(this.x-a.x,this.y-a.y)};crow.GridNode.prototype.generateId=function(){return this.id=this.x+"_"+this.y};
crow.GridNode.prototype.getNeighbors=function(a,b,c){var d=this.x,e=this.y,f=[];f.push(a.getNode(d+1,e));b&&f.push(a.getNode(d+1,e+1));f.push(a.getNode(d,e+1));b&&f.push(a.getNode(d-1,e+1));f.push(a.getNode(d-1,e));b&&f.push(a.getNode(d-1,e-1));f.push(a.getNode(d,e-1));b&&f.push(a.getNode(d+1,e-1));a=[];for(b=0;b<f.length;b++)(d=f[b])?a.push(d):c&&a.push(null);return a};crow.BaseNode=crow.GridNode;crow.algorithm.Path=function(a){this.nodes=a.nodes;this.start=a.start;this.end=this.goal=a.goal;this.length=a.length;this.found=a.found;this.actor=this.graph=this.algorithm=null;this._baked=!0;!1===a.baked&&(this._baked=!1,this.algorithm=a.algorithm,this.graph=a.graph,this.actor=a.actor,this.graph&&(this.graph.validator.addEventListener("invalidatePoint",this._invalidatePoint,null,this),this.graph.validator.addEventListener("invalidateRegion",this._invalidateRegion,null,this)))};
crow.algorithm.Path.prototype.copyTo=function(a){for(var b in this)a[b]=this[b]};crow.algorithm.Path.prototype._invalidatePoint=function(a){this._baked||this.algorithm._invalidatePoint(this,a)};crow.algorithm.Path.prototype._invalidateRegion=function(a){this._baked||this.algorithm._invalidateRegion(this,a)};
crow.algorithm.Path.prototype.advanceTo=function(a){crow.assert("number"===typeof a||a instanceof crow.BaseNode,crow.assert.InvalidArgumentType("number or crow.BaseNode"));if("number"===typeof a)return crow.assert(0<=a&&a<this.nodes.length,crow.assert.IndexOutBounds(a)),this.advanceTo(this.nodes[a]);var b=a.x,c=a.y,d,e=!1;for(d=0;d<this.nodes.length;d++){var f=this.nodes[d];if(f.x===b&&f.y===c){e=!0;break}}e?(this.start=a,this.found=!1,this.algorithm.moveStart&&this.algorithm.moveStart(this,a)):(this.nodes=
[a],this.found=!1,this.end=null)};crow.algorithm.Path.prototype.moveTarget=function(a){if(!this.algorithm.klass.attributes.moving_goal)throw Error(crow.assert.IllegalMethodCall("moveGoal","This method is intended only to be used with algorithms that support moving targets."));this.goal=a;this.found=!1;this.algorithm.moveTarget&&this.algorithm.moveTarget(this,a)};crow.algorithm.Path.prototype.getNextNode=function(){return this.nodes[1]};
crow.algorithm.Path.prototype.continueCalculating=function(a){if(this._baked)throw Error("Can't continue calculating a baked path.  Either pass {baked: false} to findGoal, or don't call .bake() on this path yet.");return this.found?!0:this.algorithm.continueCalculating(this,a)};
crow.algorithm.Path.prototype.bake=function(){this._baked=!0;this.graph&&(this.graph.validator.removeEventListener("invalidatePoint",this._invalidatePoint),this.graph.validator.removeEventListener("invalidateRegion",this._invalidateRegion),this.graph=null);this.actor=this.algorithm=null};crow.algorithm.AStarAlgorithm={};
(function(){crow.algorithm.AStarAlgorithm=function(a){this.klass=crow.algorithm.AStarAlgorithm;this.graph=a};crow.algorithm.AStarAlgorithm.prototype=new crow.algorithm.ShortestPathAlgorithm;crow.algorithm.AStarAlgorithm.prototype.findPath=function(a,b,c){crow.algorithm.ShortestPathAlgorithm.prototype.findPath.apply(this,arguments);if("function"===typeof b)throw Error("A* doesn't support using a callback to determine the goal");this._wrapperNode=new crow.Algorithm.NodeMap;c||(c={});var d=c.actor;this.start=
a;this.goal=b;this.opts=c;a=this._getWrapperNode(a);this.openSet=new crow.structs.BucketPriorityQueue;this.openSet.enqueue(0,a);a.g=0;a.h=a.innerNode.distanceToGoal(b,d);for(var e=!1,f;f=this.openSet.dequeue();){if(f.innerNode===b){e=!0;break}else if(f.expanded)continue;f.expanded=!0;for(var g=f.innerNode.getNeighbors(this.graph),h=0;h<g.length;h++){var k=this._getWrapperNode(g[h]);if(!k.expanded){var l=f.g+f.innerNode.distanceToNeighbor(k.innerNode,d);if(Infinity!=l&&(!this.openSet.contains(k)||
l<k.g)){k.parent=f;k.g=l;var m=k.innerNode.distanceToGoal(b,d);k.f=l+m;this.openSet.enqueue(k.f,k)}}}}f=[];d={nodes:f,start:a.innerNode,goal:b,length:null,recalculate:this.recalculate,algorithm:this,graph:c.graph,baked:c.baked||"undefined"===typeof c.baked&&!c.limit,actor:d};if(e){e=this._getWrapperNode(b);f.unshift(e.innerNode);for(g=e.parent;g;)f.unshift(g.innerNode),g=g.parent;d.end=e.innerNode;d.length=e.g;d.found=!0}else d.end=null,d.length=Infinity,d.found=!1;return new crow.algorithm.Path(d)};
crow.algorithm.AStarAlgorithm.WrapperNode=function(a){this.innerNode=a;this.expanded=!1;this.parent=null;this.g=Infinity;this.f=this.h=null};crow.algorithm.AStarAlgorithm.prototype._getWrapperNode=crow.Algorithm.wrapperNodeGetterTemplate(crow.algorithm.AStarAlgorithm.WrapperNode);crow.algorithm.AStarAlgorithm.attributes={min_speed:2,moving_start:!1,moving_goal:!1,unstable_graph:!1,heuristics_allowed:!0,goal_is_node:!0,goal_is_callback:!1};crow.algorithm.AStarAlgorithm.alias="a*";crow.Graph.registerAlgorithm(crow.algorithm.AStarAlgorithm)})();crow.algorithm.BasicTraversalAlgorithm={};
(function(){crow.algorithm.BasicTraversalAlgorithm=function(a){this.klass=crow.algorithm.BasicTraversalAlgorithm;this.graph=a};crow.algorithm.BasicTraversalAlgorithm.prototype=new crow.algorithm.ShortestPathAlgorithm;crow.algorithm.BasicTraversalAlgorithm.prototype.findPath=function(a,b,c){crow.algorithm.ShortestPathAlgorithm.prototype.findPath.apply(this,arguments);"undefined"==typeof c&&(c={});a=this._getWrapperNode(a);a.distance=0;this.actor=c.actor;for(var d=c.filter,e=!1,f=[a],g=[],h;h=this.getNext(f);){h.pending=
!1;h.expanded=!0;g.push(h.innerNode);if(h.innerNode==b){e=!0;break}var k=h.innerNode.getNeighbors(this.graph);c.random&&(k=k.shuffle());for(var l=0;l<k.length;l++){var m=this._getWrapperNode(k[l]);if(!m.expanded&&!m.pending&&Infinity>h.innerNode.distanceToNeighbor(m.innerNode,this.actor)&&(!d||d.call(this,m)))this.addNext(f,m),m.pending=!0,m.parent=h,m.distance=h.distance+1}}this.start=a;this.goal=b;this.list=g;return this.resolveResults(e)};crow.algorithm.BasicTraversalAlgorithm.prototype.getNext=
function(a){throw Error("must implement");};crow.algorithm.BasicTraversalAlgorithm.prototype.addNext=function(a,b){a.push(b)};crow.algorithm.BasicTraversalAlgorithm.prototype.resolveResults=function(a){var b=[],c={nodes:b,start:this.start.innerNode,goal:this.goal,algorithm:this,graph:this.graph,baked:!0,actor:this.actor,found:a};if(a){a=this._getWrapperNode(this.goal);b.unshift(a.innerNode);for(var d=a.parent;d;)b.unshift(d.innerNode),d=d.parent;c.end=a.innerNode;c.length=a.distance}else c.end=null,
c.length=Infinity;b=new crow.algorithm.Path(c);b.allNodes=this.list;return b};crow.algorithm.BasicTraversalAlgorithm.WrapperNode=function(a){this.innerNode=a;this.pending=this.expanded=!1;this.parent=null;this.distance=Infinity};crow.algorithm.BasicTraversalAlgorithm.prototype._getWrapperNode=crow.Algorithm.wrapperNodeGetterTemplate(crow.algorithm.BasicTraversalAlgorithm.WrapperNode)})();crow.algorithm.BFSAlgorithm=function(a){this.klass=crow.algorithm.BFSAlgorithm;this.graph=a};crow.algorithm.BFSAlgorithm.prototype=new crow.algorithm.BasicTraversalAlgorithm;crow.algorithm.BFSAlgorithm.prototype.getNext=function(a){return a.shift()};crow.algorithm.BFSAlgorithm.alias="bfs";crow.Graph.registerAlgorithm(crow.algorithm.BFSAlgorithm);crow.algorithm.SearchAlgorithm=function(){};crow.algorithm.SearchAlgorithm.prototype=new crow.Algorithm;crow.algorithm.SearchAlgorithm.prototype.search=function(a,b){this.wrapperNode=new crow.Algorithm.NodeMap};crow.algorithm.BFSBasicAlgorithm=function(a){this.klass=crow.algorithm.BFSBasicAlgorithm;this.graph=a};crow.algorithm.BFSBasicAlgorithm.prototype=new crow.algorithm.SearchAlgorithm;crow.algorithm.BFSBasicAlgorithm.prototype.search=function(a,b){return(new crow.algorithm.BFSAlgorithm(this.graph)).findPath(a,null,b).allNodes};crow.algorithm.BFSBasicAlgorithm.alias="bfs_basic";crow.Graph.registerAlgorithm(crow.algorithm.BFSBasicAlgorithm);crow.algorithm.DFSAlgorithm=function(a){this.klass=crow.algorithm.DFSAlgorithm;this.graph=a};crow.algorithm.DFSAlgorithm.prototype=new crow.algorithm.BasicTraversalAlgorithm;crow.algorithm.DFSAlgorithm.prototype.getNext=function(a){return a.pop()};crow.algorithm.DFSAlgorithm.alias="dfs";crow.Graph.registerAlgorithm(crow.algorithm.DFSAlgorithm);crow.algorithm.DijkstraAlgorithm=function(a){this.klass=crow.algorithm.DijkstraAlgorithm;this.graph=a};crow.algorithm.DijkstraAlgorithm.prototype=new crow.algorithm.ShortestPathAlgorithm;
crow.algorithm.DijkstraAlgorithm.prototype.findPath=function(a,b,c){crow.algorithm.ShortestPathAlgorithm.prototype.findPath.apply(this,arguments);this.visitedList=[];this.start=a;this.goal=b;this.opts=c||{};if(c.limit)throw Error("Dijkstra's doesn't support the `limit` option.");this.actor=c.actor;this._getWrapperNode(a).distance=0;var d,e;"function"===typeof b?(this.mainLoop(a),d=this.determineClosestEndNode(b),e=!!d):(e=this.mainLoop(a,b),d=this._getWrapperNode(b));var f=[];if(Infinity>d.distance){f.unshift(d.innerNode);
for(var g=d.previous;g;)f.unshift(g.innerNode),g=g.previous}return new crow.algorithm.Path({nodes:f,start:a,goal:b,end:e?d.innerNode:null,length:e?d.distance:Infinity,found:e,algorithm:this,graph:c.graph,baked:c.baked||"undefined"===typeof c.baked&&!c.limit,actor:this.actor})};crow.algorithm.DijkstraAlgorithm.prototype.determineClosestEndNode=function(a){for(var b,c=Infinity,d=0;d<this.visitedList.length;d++){var e=this.visitedList[d];if(a.call(e.innerNode)){var f=e.distance;f<c&&(b=e,c=f)}}return b};
crow.algorithm.DijkstraAlgorithm.prototype.mainLoop=function(a,b){var c=new crow.Algorithm.PriorityQueue;for(a=this._getWrapperNode(a);null!=a;){for(var d=a.innerNode.getNeighbors(this.graph),e=0;e<d.length;e++){var f=this._getWrapperNode(d[e]);if(!f.visited){var g=a.distance+a.innerNode.distanceToNeighbor(f.innerNode,this.actor),h=f.distance;g<h&&(f.distance=g,f.previous=a,h=g);Infinity>h&&c.enqueue(h,f)}}a.visited=!0;this.visitedList.push(a);if(a.innerNode===b)return!0;a=c.dequeue()}return!1};
crow.algorithm.DijkstraAlgorithm.WrapperNode=function(a){this.innerNode=a;this.visited=!1;this.previous=null;this.distance=Infinity};crow.algorithm.DijkstraAlgorithm.prototype._getWrapperNode=crow.Algorithm.wrapperNodeGetterTemplate(crow.algorithm.DijkstraAlgorithm.WrapperNode);crow.algorithm.DijkstraAlgorithm.attributes={min_speed:-2,moving_start:!1,moving_goal:!1,unstable_graph:!1,heuristics_allowed:!1,goal_is_node:!0,goal_is_callback:!0};crow.algorithm.DijkstraAlgorithm.alias="dijkstra";crow.Graph.registerAlgorithm(crow.algorithm.DijkstraAlgorithm);crow.algorithm.FRAStarAlgorithm=function(a){this.klass=crow.algorithm.FRAStarAlgorithm;this.graph=a};crow.algorithm.FRAStarAlgorithm.prototype=new crow.algorithm.ShortestPathAlgorithm;crow.algorithm.FRAStarAlgorithm.prototype._invalidatePoint=function(a,b){crow.Algorithm.prototype._invalidatePoint.apply(this,arguments);this.reset()};
crow.algorithm.FRAStarAlgorithm.prototype.reset=function(){this.wrapperNode=new crow.Algorithm.NodeMap;this.start=this._getWrapperNode(this.start.innerNode);this.goal=this._getWrapperNode(this.goal.innerNode);this.iteration=1;this.start.initialize();this.start.g=0;this.evaluatedList=[];this.openSet=new crow.structs.BucketPriorityQueue;this.openSet.enqueue(0,this.start);this.state=1};crow.algorithm.FRAStarAlgorithm.prototype.ComputePriority=function(a){return a.g+a.innerNode.distanceToGoal(this.goal.innerNode)};
crow.algorithm.FRAStarAlgorithm.prototype.TestClosedList=function(a){return a==this.start||!(!a.expanded||!a.parent)};
crow.algorithm.FRAStarAlgorithm.prototype.ComputeShortestPath=function(){for(;node=this.openSet.dequeue();)if(!node.expanded){node.expanded=!0;for(var a=node.innerNode.getNeighbors(this.graph,this.neighbors),b=0;b<a.length;b++){var c=this._getWrapperNode(a[b]);if(!this.TestClosedList(c)){c.initialize();var d=node.g+node.innerNode.distanceToNeighbor(c.innerNode);d<c.g&&(c.g=d,c.parent=node,this.openSet.enqueue(this.ComputePriority(c),c))}}if(node==this.goal)return!0}return!1};
crow.algorithm.FRAStarAlgorithm.prototype.UpdateParent=function(a){var b=this.cell,c=b.innerNode.getNeighbors(this.graph,this.diagonals);a||(c=c.reverse());var d=b.parent;a=-1;for(var e=0;e<c.length;e++)if(c[e]==d){a=e;break}if(0<=a)for(e=0;e<c.length;e++)if(d=this._getWrapperNode(c[(e+a)%c.length]),d.g==b.g+b.innerNode.distanceToNeighbor(d.innerNode)&&this.TestClosedList(d))return d.parent=b,this.cell=d,!0;return!1};
crow.algorithm.FRAStarAlgorithm.prototype.Step2=function(){for(this.cell=this.start;this.UpdateParent(!1););for(this.cell=this.start;this.UpdateParent(!0););};
crow.algorithm.FRAStarAlgorithm.prototype.Step3=function(){this.start.parent=null;for(var a=this.start,b=this.previousStart,c=new crow.algorithm.BFSBasicAlgorithm(this.graph),d=this._getWrapperNode,e=this,c=c.search(this.previousStart.innerNode,{filter:function(c){c=d.call(e,c).ancestors();return 0<=c.indexOf(b)&&0>c.indexOf(a)}}),f=0;f<c.length;f++){var g=this._getWrapperNode(c[f]);g.parent=null;this.openSet.remove(g)}};
crow.algorithm.FRAStarAlgorithm.prototype.FindPerimeter=function(a,b){var c=[b],d=a.innerNode.getNeighbors(this.graph,this.diagonals,!0),e;for(e=0;e<d.length;e++){var f=d[e];if(f==b.innerNode)break}for(var f=a,g=0;g<d.length;g++){var h=(e+g)%d.length;if(f=d[h])if(f=this._getWrapperNode(f),this.TestClosedList(f))if(f==a)break;else d=f.innerNode.getNeighbors(this.graph,this.diagonals,!0),e=h+3,g=-1;else c[c.length-1]!=f&&c.push(f)}return c};
crow.algorithm.FRAStarAlgorithm.prototype.Step5=function(){for(var a=this.FindPerimeter(this.start,this.anchor),b=0;b<a.length;b++){var c=a[b];this.openSet.enqueue(this.ComputePriority(c),c)}var d=this;this.openSet.each(function(a){a.initialize()});var e=[];this.openSet.each(function(a){for(var b=a.innerNode.getNeighbors(d.graph,d.diagonals),c=0;c<b.length;c++){var k=d._getWrapperNode(b[c]),l=k.g+k.innerNode.distanceToNeighbor(a.innerNode);d.TestClosedList(k)&&a.g>l&&(a.g=l,a.parent=k,e.push(a))}});
for(b=0;b<e.length;b++)a=e[b],this.openSet.enqueue(this.ComputePriority(a),a)};crow.algorithm.FRAStarAlgorithm.prototype.findPath=function(a,b,c){c||(c={});crow.algorithm.ShortestPathAlgorithm.prototype.findPath.apply(this,arguments);a=this._getWrapperNode(a);b=this._getWrapperNode(b);this.start=a;this.goal=b;this.opts=c;this.reset();var d=this.resolveResults(this.opts,!1);this.continueCalculating(d);return d};
crow.algorithm.FRAStarAlgorithm.prototype.resolveResults=function(a,b){a||(a={});var c;c=b?{nodes:this.goal.ancestors(!0).concat(this.goal.innerNode),start:this.start.innerNode,goal:this.goal.innerNode,found:!0,length:this.goal.g,algorithm:this,graph:a.graph,baked:a.baked||"undefined"===typeof a.baked,actor:a.actor}:{nodes:[],start:this.start.innerNode,goal:this.goal.innerNode,found:!1,length:Infinity,algorithm:this,graph:a.graph,baked:a.baked||"undefined"===typeof a.baked,actor:a.actor};return new crow.algorithm.Path(c)};
crow.algorithm.FRAStarAlgorithm.prototype.updateStart=function(a){for(var b=!1,c=0;c<a.nodes.length;c++)if(a.nodes[c]==this.start.innerNode){a.nodes.splice(0,c);b=!0;break}if(b){for(c=b=0;c<a.nodes.length-1;c++)b+=a.nodes[c].distanceToNeighbor(a.nodes[c+1]);a.length=b}else throw Error("Present (start) position not found on path!  FRA* only works if this agent follows the path towards the target.");};
crow.algorithm.FRAStarAlgorithm.prototype.continueCalculating=function(a){this.start=this._getWrapperNode(this.start);this.goal=this._getWrapperNode(this.goal);this.previousStart&&(this.previousStart=this._getWrapperNode(this.previousStart));this.previousGoal&&(this.previousGoal=this._getWrapperNode(this.previousGoal));for(;;)switch(this.state){case 1:if(this.start==this.goal)this.state=!0;else{var b=this.ComputeShortestPath(),c=this.resolveResults(null,b);a.found=b;a.nodes=c.nodes;a.length=this.goal.g;
b?(this.openListIncomplete=!1,this.state=3):this.state=!1}break;case 3:this.TestClosedList(this.goal)?this.state=4:this.state=5;break;case 4:if(this.start!=this.goal)for(b=0;b<a.nodes.length;b++)if(a.nodes[b]==this.goal.innerNode)return this.updateStart(a),!0;this.start==this.goal?this.state=!0:(this.newTarget&&(this.previousGoal=this.goal,this.goal=this._getWrapperNode(this.newTarget),this.newTarget=null),this.previousStart||(this.previousStart=this.start),this.start!=this.previousStart&&(this.Step2(),
this.anchor=this.start.parent,this.Step3(),this.openListIncomplete=!0),this.state=3);break;case 5:this.openListIncomplete&&(this.iteration++,this.Step5());this.state=1;break;case !0:return a.found=!0,a.nodes=[a.goal],a.length=0,!0;case !1:return a.found=!1,a.nodes=[],a.length=Infinity,!1}};crow.algorithm.FRAStarAlgorithm.prototype.moveStart=function(a,b){this.previousStart=this.start;this.start=b};
crow.algorithm.FRAStarAlgorithm.prototype.moveTarget=function(a,b){this.previousGoal=this.goal;this.goal=b};crow.algorithm.FRAStarAlgorithm.WrapperNode=function(a){this.innerNode=a;this.generatedIteration=0;this.expanded=!1;this.parent=this.g=null};crow.algorithm.FRAStarAlgorithm.prototype._getWrapperNode=crow.Algorithm.wrapperNodeGetterTemplate(crow.algorithm.FRAStarAlgorithm.WrapperNode);
crow.algorithm.FRAStarAlgorithm.WrapperNode.prototype.initialize=function(){var a=this.algorithm.iteration;this.generatedIteration!=a&&(this.g=Infinity,this.generatedIteration=a,this.expanded=!1)};crow.algorithm.FRAStarAlgorithm.WrapperNode.prototype.ancestors=function(a){for(var b=[],c=this.parent;c;)b.unshift(a?c.innerNode:c),c=c.parent;return b};crow.algorithm.FRAStarAlgorithm.attributes={min_speed:2,moving_start:!0,moving_goal:!0,unstable_graph:!1,heuristics_allowed:!0,goal_is_node:!0,goal_is_callback:!1};
crow.algorithm.FRAStarAlgorithm.alias="fra*";crow.Graph.registerAlgorithm(crow.algorithm.FRAStarAlgorithm);crow.algorithm.LinearAlgorithm=function(a){this.klass=crow.algorithm.LinearAlgorithm;this.graph=a};crow.algorithm.LinearAlgorithm.prototype=new crow.algorithm.SearchAlgorithm;crow.algorithm.LinearAlgorithm.prototype.search=function(a,b){b||(b={});var c,d=this.graph.getNodes();if(b.filter){c=[];for(var e=0;e<d.length;e++){var f=d[e];b.filter.call(f)&&c.push(f)}}else c=d;return c};crow.algorithm.LinearAlgorithm.alias="linear";crow.Graph.registerAlgorithm(crow.algorithm.LinearAlgorithm);crow.structs.NDArray=function(a){this.arr=[];this.dimensions=a};crow.structs.NDArray.prototype.add=function(a){if(arguments.length-1!=this.dimensions)throw Error(crow.assert.IncorrectArgumentCount(arguments.length,this.dimensions+1));for(var b=this.arr,c=b,d=arguments.length,e=1;e<d-1;e++)c=b[arguments[e]],"undefined"===typeof c&&(c=b[arguments[e]]=[]),b=c;c[arguments[d-1]]=a};
crow.structs.NDArray.prototype.get=function(){if(arguments.length!=this.dimensions)throw new crow.assert.IncorrectArgumentCount(arguments.length,this.dimensions);for(var a=this.arr,b=0;b<arguments.length&&"undefined"!==typeof a;b++)a=a[arguments[b]];return a};crow.structs.NDArray.prototype.each=function(a){for(var b=0;b<this.arr.length;b++){var c=this.arr[b];"undefined"!==typeof c&&this._each(a,c,[b])}};
crow.structs.NDArray.prototype._each=function(a,b,c){if(b instanceof Array&&c.length<=this.dimensions)for(var d=0;d<b.length;d++){var e=c.slice(0).concat(d),f=b[d];"undefined"!==typeof f&&this._each(a,f,e)}else c.unshift(b),a.apply(this,c)};crow.algorithm.LPAStarAlgorithm=function(a){this.klass=crow.algorithm.LPAStarAlgorithm;this.graph=a};crow.algorithm.LPAStarAlgorithm.prototype=new crow.algorithm.ShortestPathAlgorithm;crow.algorithm.LPAStarAlgorithm.prototype._CalculateKey=function(a){var b=Math.min(a.g,a.rhs);return[b+a.innerNode.distanceToGoal(this.goal.innerNode),b]};
crow.algorithm.LPAStarAlgorithm.prototype._UpdateVertex=function(a){if(a!=this.start){for(var b=a.innerNode.getNeighbors(this.graph,this.diagonals),c=Infinity,d=0;d<b.length;d++){var e=this._getWrapperNode(b[d]),e=e.g+a.innerNode.distanceToNeighbor(e.innerNode);e<c&&(c=e)}a.rhs=c}this.U.remove(a);a.g!=a.rhs&&this.U.enqueue(this._CalculateKey(a),a)};crow.algorithm.LPAStarAlgorithm.prototype.keyComp=function(a,b){return a[0]<b[0]||a[0]==b[0]&&a[1]<b[1]?-1:a[0]==b[0]&&a[1]==b[1]?0:1};
crow.algorithm.LPAStarAlgorithm.prototype.updateNeighbors=function(a){a=a.innerNode.getNeighbors(this.graph,this.diagonals);for(var b=0;b<a.length;b++)this._UpdateVertex(this._getWrapperNode(a[b]))};crow.algorithm.LPAStarAlgorithm.prototype.debugGraph=function(){};
crow.algorithm.LPAStarAlgorithm.prototype.findPath=function(a,b,c){if("function"===typeof b)throw Error("LPA* doesn't support using a callback to determine the goal");c||(c={});this._wrapperNode=new crow.Algorithm.NodeMap;this.start=this._getWrapperNode(a);this.goal=this._getWrapperNode(b);this.diagonals=c.diagonals;this.U=new crow.structs.BucketPriorityQueue(this.keyComp);this.start.rhs=0;this.U.enqueue(this._CalculateKey(this.start),this.start);this.mainLoop();a=this.resolveResults();return new crow.algorithm.Path({nodes:a.nodes,
start:this.start.innerNode,goal:this.goal.innerNode,found:a.found,length:a.length,recalculate:this.recalculate,algorithm:this,baked:c.baked||"undefined"===typeof c.baked&&!c.limit,graph:c.graph})};crow.algorithm.LPAStarAlgorithm.prototype.mainLoop=function(){for(;this.U.length&&(0>this.keyComp(this.U.peekKey(),this._CalculateKey(this.goal))||this.goal.rhs!=this.goal.g);){var a=this.U.dequeue();a.g>a.rhs?(a.g=a.rhs,this.updateNeighbors(a)):(a.g=Infinity,this.updateNeighbors(a),this._UpdateVertex(a))}};
crow.algorithm.LPAStarAlgorithm.prototype.resolveResults=function(){var a=[],b=this.goal,c=0,d=0;for(this.graph&&(failSafeMaximum=this.graph.width*this.graph.height);b!=this.start&&b;){a.unshift(b.innerNode);for(var e=b.innerNode.getNeighbors(this.graph,this.diagonals),f=Infinity,g=null,h=0,k=0,l=0;l<e.length;l++){var m=this._getWrapperNode(e[l]),h=b.innerNode.distanceToNeighbor(m.innerNode),n=m.g+h;n<f&&(f=n,g=m,k=h)}(b=g)&&(c+=k);d++;if(Infinity<=d)throw Error("resolveResults won't terminate");
}(b=b==this.start)||(a=[]);a.unshift(this.start.innerNode);return{nodes:a,length:c,found:b}};crow.algorithm.LPAStarAlgorithm.prototype.recalculate=function(){var a=this.algorithm;return a.findPath(a.start,a.goal,a.opts)};
crow.algorithm.LPAStarAlgorithm.prototype._invalidatePoint=function(a,b){var c=b.x,d=b.y;a.invalidatedPoints||(a.invalidatedPoints=new crow.structs.NDArray(2));a.invalidatedPoints.add(!0,c,d);c=a.graph.getNode(c,d,!0).getNeighbors(a.graph,a.algorithm.diagonals);for(d=0;d<c.length;d++){var e=c[d];a.invalidatedPoints.add(!0,e.x,e.y)}a.found=!1};
crow.algorithm.LPAStarAlgorithm.prototype.continueCalculating=function(a){if(a.invalidatedPoints){var b=this,c=this._getWrapperNode;a.invalidatedPoints.each(function(a,d,g){(a=b.graph.getNode(d,g))&&b._UpdateVertex(c.call(b,a))});this.mainLoop();a.invalidatedPoints=new crow.structs.NDArray(2);var d=this.resolveResults();a.nodes=d.nodes;a.length=d.length;a.found=d.found}return a.found};
crow.algorithm.LPAStarAlgorithm.prototype._getWrapperNode=function(a){var b=this._wrapperNode.get(a);if(b)return b;b=new crow.algorithm.LPAStarAlgorithm.WrapperNode(a);this._wrapperNode.set(a,b);return b};crow.algorithm.LPAStarAlgorithm.WrapperNode=function(a){this.innerNode=a;this.g=this.rhs=Infinity};crow.algorithm.LPAStarAlgorithm.attributes={min_speed:0,moving_start:!1,moving_goal:!1,unstable_graph:!0,heuristics_allowed:!0,goal_is_node:!0,goal_is_callback:!1};
crow.algorithm.LPAStarAlgorithm.alias="lpa*";crow.Graph.registerAlgorithm(crow.algorithm.LPAStarAlgorithm);crow.ConnectedNode=function(a){crow.Node.apply(this,arguments);this.connections=[];this.connectionDistances={}};crow.ConnectedNode.prototype=new crow.Node;crow.ConnectedNode.prototype.connectTo=function(a,b,c){"undefined"==typeof b&&(b=1);this.connections.push(a);this.connectionDistances[a.id]=b;"false"!==typeof c&&a instanceof crow.ConnectedNode&&(a.connections.push(this),a.connectionDistances[this.id]=b)};crow.ConnectedNode.prototype.getNeighbors=function(){return this.connections};
crow.ConnectedNode.prototype.distanceToNeighbor=function(a){return this.connectionDistances[a.id]||Infinity};crow.All={};
